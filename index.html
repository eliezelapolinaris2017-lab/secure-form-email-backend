<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Puerto Rico Dresses — Formulario</title>

  <style>
    :root{
      --bg:#f3f4f6;
      --card:#ffffff;
      --text:#111827;
      --muted:#6b7280;
      --border:#e5e7eb;
      --shadow:0 10px 28px rgba(0,0,0,.08);
      --btn:#1f6f8b;        /* parecido al azul del ejemplo */
      --btn-hover:#195d74;
      --radius:12px;
    }

    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:var(--bg);
      color:var(--text);
    }

    .wrap{max-width:520px;margin:24px auto;padding:16px}
    .card{
      background:var(--card);
      border-radius:var(--radius);
      padding:22px 22px 18px;
      box-shadow:var(--shadow);
      border:1px solid rgba(0,0,0,.04);
    }

    .brand{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:10px;
      margin-bottom:10px;
    }

    .logo{
      width:120px;height:54px;
      display:flex;align-items:center;justify-content:center;
      color:#111827;
      font-weight:800;
      letter-spacing:.5px;
      border-radius:10px;
      background:#fff;
    }

    .title{
      text-align:left;
      font-size:20px;
      font-weight:500;
      margin:6px 0 16px;
      color:#374151;
    }

    label{
      display:block;
      font-weight:700;
      font-size:13px;
      margin:14px 0 6px;
      color:#111827;
    }

    .opt{
      font-weight:700;
      font-size:11px;
      color:#9ca3af;
      margin-left:6px;
    }

    input, select, textarea{
      width:100%;
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius:10px;
      font-size:14px;
      outline:none;
      background:#fff;
    }

    textarea{min-height:110px;resize:vertical}

    .help{
      margin:10px 0 2px;
      font-size:13px;
      color:#374151;
      line-height:1.35;
      white-space:pre-line;
    }

    .note{
      margin-top:12px;
      font-size:13px;
      color:#111827;
      line-height:1.35;
    }
    .note b{display:block;margin-bottom:6px}

    button{
      margin-top:14px;
      width:100%;
      padding:12px;
      background:var(--btn);
      color:#fff;
      border:none;
      border-radius:10px;
      font-weight:800;
      cursor:pointer;
      transition:.15s ease;
    }
    button:hover{background:var(--btn-hover)}
    button:disabled{opacity:.65;cursor:not-allowed}

    .msg{margin-top:10px;font-size:13px}
    .ok{color:#0a7b34;font-weight:800}
    .err{color:#b42318;font-weight:800}

    .legal{
      margin-top:14px;
      font-size:11.5px;
      color:var(--muted);
      text-align:center;
    }
  </style>

  <!-- CONFIG (NO TOCAR si ya te funciona) -->
  <script>
    const SITE_KEY = "6LdB4jAsAAAAALaPzH7IBial1E3b5I4PG77-P15n";
    const BACKEND_URL = "https://secure-form-email-backend.onrender.com";
  </script>

  <!-- Google reCAPTCHA v3 -->
  <script src="https://www.google.com/recaptcha/api.js?render=6LdB4jAsAAAAALaPzH7IBial1E3b5I4PG77-P15n"></script>
</head>

<body>
  <div class="wrap">
    <div class="card">

      <div class="brand">
        <!-- Logo “tipo firma” simple (sin assets). Si luego quieres imagen real, lo cambiamos a <img>. -->
        <div class="logo">Puerto Rico Dresses</div>
      </div>

      <div class="title">Puerto Rico Dresses Experience.</div>

      <form id="form">
        <label for="name">Name</label>
        <input id="name" name="name" required>

        <label for="email">Email Address</label>
        <input id="email" name="email" type="email" required>

        <label for="phone">Phone Number</label>
        <input id="phone" name="phone" required>

        <label for="service">Servicio que usted desea</label>
        <select id="service" name="service" required>
          <option value="">— Select —</option>
          <option>Servicio 1</option>
          <option>Servicio 2</option>
          <option>Servicio 3</option>
        </select>

        <div class="help">
Escriba en el encasillado de trabajo cualquiera de las siguientes:

Para Bodas/Quinceañeros mencione donde sera la recepción.
Para Underwater Photography escriba Piscina o Manantial.
Para sesión de Parejas y Modelos mencione lugar deseado.
De no tener alguno escriba n/a.
        </div>

        <label for="actividad">¿Dónde será su actividad? <span class="opt">(OPTIONAL)</span></label>
        <textarea id="actividad" name="actividad"></textarea>

        <label for="ciudad">Ciudad del Evento <span class="opt">(OPTIONAL)</span></label>
        <input id="ciudad" name="ciudad">

        <label for="dia">Dia de su evento <span class="opt">(OPTIONAL)</span></label>
        <input id="dia" name="dia" placeholder="" />

        <label for="hora">Hora del Evento <span class="opt">(OPTIONAL)</span></label>
        <input id="hora" name="hora" placeholder="" />

        <label for="coordinador">¿Tienes Coordinador de eventos? ¿Cuál es su nombre? <span class="opt">(OPTIONAL)</span></label>
        <input id="coordinador" name="coordinador">

        <div class="note">
          <b>Nota*</b>
          Fecha sujetas a disponibilidad.<br>
          Usted recibirá un correo electrónico con su cotización inmediatamente presione SUBMIT.
        </div>

        <!-- Este campo es el que tu backend ya entiende. Lo llenamos automático en JS. -->
        <textarea name="details" id="details" style="display:none"></textarea>

        <button type="submit" id="btn">Submit</button>
        <div class="msg" id="msg"></div>

        <div class="legal">
          This form is protected by reCAPTCHA and the Google Privacy Policy and Terms of Service apply.
        </div>
      </form>
    </div>
  </div>

  <script>
    const form = document.getElementById("form");
    const btn = document.getElementById("btn");
    const msg = document.getElementById("msg");
    const detailsField = document.getElementById("details");

    function buildDetails(data){
      // Empaquetamos todo en un solo "details" para NO tocar backend.
      const lines = [
        `Servicio: ${data.service || ""}`,
        ``,
        `Instrucciones (referencia):`,
        `- Para Bodas/Quinceañeros mencione donde sera la recepción.`,
        `- Para Underwater Photography escriba Piscina o Manantial.`,
        `- Para sesión de Parejas y Modelos mencione lugar deseado.`,
        `- De no tener alguno escriba n/a.`,
        ``,
        `¿Dónde será su actividad?: ${data.actividad || "n/a"}`,
        `Ciudad del Evento: ${data.ciudad || "n/a"}`,
        `Día de su evento: ${data.dia || "n/a"}`,
        `Hora del Evento: ${data.hora || "n/a"}`,
        `Coordinador: ${data.coordinador || "n/a"}`
      ];
      return lines.join("\n");
    }

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      btn.disabled = true;
      btn.textContent = "Enviando…";
      msg.textContent = "";

      const data = Object.fromEntries(new FormData(form).entries());
      detailsField.value = buildDetails(data);

      try {
        const token = await grecaptcha.execute(SITE_KEY, { action: "submit_form" });

        const res = await fetch(BACKEND_URL + "/api/submit", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            name: data.name,
            email: data.email,
            phone: data.phone,
            service: data.service,
            details: detailsField.value,
            recaptchaToken: token
          })
        });

        const out = await res.json();
        if (!res.ok) throw new Error(out.error || "Error");

        msg.innerHTML = `<span class="ok">Formulario enviado correctamente ✅</span>`;
        form.reset();
      } catch (err) {
        msg.innerHTML = `<span class="err">Error al enviar. Intente nuevamente.</span>`;
      } finally {
        btn.disabled = false;
        btn.textContent = "Submit";
      }
    });
  </script>
</body>
</html>
